<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convertidor Gzip - N√∫meros a Bytes</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Pako library for gzip decompression -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0">üóúÔ∏è Convertidor Gzip - N√∫meros a Bytes</h4>
                    </div>
                    <div class="card-body">
                        <form id="gzipForm">
                            <div class="mb-3">
                                <label for="numbersInput" class="form-label">
                                    <strong>Cadena de n√∫meros separados por comas:</strong>
                                </label>
                                <textarea 
                                    class="form-control" 
                                    id="numbersInput" 
                                    rows="5" 
                                    placeholder="Ejemplo: 31,139,8,0,0,0,0,0,0,255,77,205,201,10,194,48,16..."
                                    required>
                                </textarea>
                                <div class="form-text">
                                    Ingresa los n√∫meros separados por comas que representan bytes comprimidos con gzip.
                                </div>
                            </div>
                            
                            <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                                <button type="submit" class="btn btn-primary btn-lg me-md-2">
                                    <i class="bi bi-arrow-repeat"></i> Convertir y Descomprimir
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-lg" onclick="loadExample()">
                                    <i class="bi bi-file-text"></i> Cargar Ejemplo
                                </button>
                            </div>
                        </form>

                        <!-- √Årea de resultados -->
                        <div id="resultArea" class="mt-4" style="display: none;">
                            <hr>
                            <h5 class="text-success">üìã Resultado:</h5>
                            <div class="alert alert-success" role="alert">
                                <pre id="resultText" class="mb-0"></pre>
                            </div>
                        </div>

                        <!-- √Årea de errores -->
                        <div id="errorArea" class="mt-4" style="display: none;">
                            <hr>
                            <h5 class="text-danger">‚ùå Error:</h5>
                            <div class="alert alert-danger" role="alert">
                                <pre id="errorText" class="mb-0"></pre>
                            </div>
                        </div>

                        <!-- Segundo formulario: Comprimir texto a gzip -->
                        <div class="mt-5">
                            <hr class="my-4">
                            <h5 class="text-primary">üóúÔ∏è Comprimir Texto a Gzip</h5>
                            
                            <form id="compressForm">
                                <div class="mb-3">
                                    <label for="textInput" class="form-label">
                                        <strong>Texto a comprimir:</strong>
                                    </label>
                                    <textarea 
                                        class="form-control" 
                                        id="textInput" 
                                        rows="5" 
                                        placeholder="Ingresa el texto que deseas comprimir con gzip..."
                                        required>
                                    </textarea>
                                    <div class="form-text">
                                        Ingresa cualquier texto que quieras comprimir usando gzip.
                                    </div>
                                </div>
                                
                                <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                                    <button type="submit" class="btn btn-success btn-lg me-md-2">
                                        <i class="bi bi-arrow-down"></i> Comprimir a Gzip
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary btn-lg" onclick="loadTextExample()">
                                        <i class="bi bi-file-text"></i> Ejemplo de Texto
                                    </button>
                                </div>
                            </form>

                            <!-- √Årea de resultados para compresi√≥n -->
                            <div id="compressResultArea" class="mt-4" style="display: none;">
                                <hr>
                                <h5 class="text-success">üìã Resultado Comprimido:</h5>
                                <div class="alert alert-info" role="alert">
                                    <div class="mb-2">
                                        <strong>N√∫meros separados por comas:</strong>
                                    </div>
                                    <textarea 
                                        class="form-control" 
                                        id="compressResultText" 
                                        rows="5" 
                                        readonly>
                                    </textarea>
                                    <div class="mt-2">
                                        <button type="button" class="btn btn-sm btn-outline-primary" onclick="copyToClipboard()">
                                            üìã Copiar al Portapapeles
                                        </button>
                                        <button type="button" class="btn btn-sm btn-outline-success" onclick="moveToDecompress()">
                                            ‚¨ÜÔ∏è Mover a Descomprimir
                                        </button>
                                    </div>
                                    <div class="mt-2 small text-muted">
                                        <strong>Tama√±o original:</strong> <span id="originalSize"></span> bytes | 
                                        <strong>Tama√±o comprimido:</strong> <span id="compressedSize"></span> bytes | 
                                        <strong>Compresi√≥n:</strong> <span id="compressionRatio"></span>%
                                    </div>
                                </div>
                            </div>

                            <!-- √Årea de errores para compresi√≥n -->
                            <div id="compressErrorArea" class="mt-4" style="display: none;">
                                <hr>
                                <h5 class="text-danger">‚ùå Error al comprimir:</h5>
                                <div class="alert alert-danger" role="alert">
                                    <pre id="compressErrorText" class="mb-0"></pre>
                                </div>
                            </div>
                        </div>

                        <!-- Informaci√≥n adicional -->
                        <div class="mt-4">
                            <div class="card bg-light">
                                <div class="card-body">
                                    <h6 class="card-title">‚ÑπÔ∏è Informaci√≥n:</h6>
                                    <p class="card-text small mb-0">
                                        Esta herramienta permite comprimir y descomprimir datos usando gzip:
                                        <br>‚Ä¢ <strong>Descomprimir:</strong> Convierte n√∫meros separados por comas a texto original
                                        <br>‚Ä¢ <strong>Comprimir:</strong> Convierte texto a n√∫meros separados por comas (gzip comprimido)
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        document.getElementById('gzipForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Obtener el valor del input
            const numbersString = document.getElementById('numbersInput').value.trim();
            
            // Ocultar √°reas de resultado y error
            document.getElementById('resultArea').style.display = 'none';
            document.getElementById('errorArea').style.display = 'none';
            
            try {
                // Validar que no est√© vac√≠o
                if (!numbersString) {
                    throw new Error('Por favor, ingresa una cadena de n√∫meros.');
                }
                
                // Convertir la cadena de n√∫meros a un array de bytes
                const numberArray = numbersString.split(',').map(num => {
                    const parsed = parseInt(num.trim());
                    if (isNaN(parsed) || parsed < 0 || parsed > 255) {
                        throw new Error(`N√∫mero inv√°lido: "${num.trim()}". Los n√∫meros deben estar entre 0 y 255.`);
                    }
                    return parsed;
                });
                
                // Crear un Uint8Array con los bytes
                const byteArray = new Uint8Array(numberArray);
                
                // Intentar descomprimir con gzip usando pako
                const decompressed = pako.inflate(byteArray, { to: 'string' });
                
                // Mostrar el resultado
                document.getElementById('resultText').textContent = decompressed;
                document.getElementById('resultArea').style.display = 'block';
                
                // Scroll hacia el resultado
                document.getElementById('resultArea').scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                // Mostrar el error
                document.getElementById('errorText').textContent = error.message;
                document.getElementById('errorArea').style.display = 'block';
                
                // Scroll hacia el error
                document.getElementById('errorArea').scrollIntoView({ behavior: 'smooth' });
            }
        });
        
        // Manejo del formulario de compresi√≥n
        document.getElementById('compressForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Obtener el valor del input
            const textToCompress = document.getElementById('textInput').value.trim();
            
            // Ocultar √°reas de resultado y error
            document.getElementById('compressResultArea').style.display = 'none';
            document.getElementById('compressErrorArea').style.display = 'none';
            
            try {
                // Validar que no est√© vac√≠o
                if (!textToCompress) {
                    throw new Error('Por favor, ingresa un texto para comprimir.');
                }
                
                // Comprimir el texto usando pako
                const compressed = pako.gzip(textToCompress);
                
                // Convertir el array de bytes a n√∫meros separados por comas
                const numbersArray = Array.from(compressed);
                const numbersString = numbersArray.join(',');
                
                // Mostrar el resultado
                document.getElementById('compressResultText').value = numbersString;
                document.getElementById('compressResultArea').style.display = 'block';
                
                // Mostrar estad√≠sticas
                const originalSize = new TextEncoder().encode(textToCompress).length;
                const compressedSize = compressed.length;
                const compressionRatio = ((1 - compressedSize / originalSize) * 100).toFixed(1);
                
                document.getElementById('originalSize').textContent = originalSize;
                document.getElementById('compressedSize').textContent = compressedSize;
                document.getElementById('compressionRatio').textContent = compressionRatio;
                
                // Scroll hacia el resultado
                document.getElementById('compressResultArea').scrollIntoView({ behavior: 'smooth' });
                
            } catch (error) {
                // Mostrar el error
                document.getElementById('compressErrorText').textContent = error.message;
                document.getElementById('compressErrorArea').style.display = 'block';
                
                // Scroll hacia el error
                document.getElementById('compressErrorArea').scrollIntoView({ behavior: 'smooth' });
            }
        });
        
        // Funci√≥n para copiar al portapapeles
        function copyToClipboard() {
            const resultText = document.getElementById('compressResultText');
            resultText.select();
            document.execCommand('copy');
            
            // Feedback visual
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '‚úÖ Copiado!';
            button.classList.remove('btn-outline-primary');
            button.classList.add('btn-success');
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('btn-success');
                button.classList.add('btn-outline-primary');
            }, 2000);
        }
        
        // Funci√≥n para mover el resultado al campo de descompresi√≥n
        function moveToDecompress() {
            const compressedNumbers = document.getElementById('compressResultText').value;
            document.getElementById('numbersInput').value = compressedNumbers;
            
            // Scroll hacia arriba
            document.getElementById('numbersInput').scrollIntoView({ behavior: 'smooth' });
            
            // Feedback visual
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '‚úÖ Movido!';
            button.classList.remove('btn-outline-success');
            button.classList.add('btn-success');
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('btn-success');
                button.classList.add('btn-outline-success');
            }, 2000);
        }
        
        // Ejemplo de texto para comprimir
        function loadTextExample() {
            const exampleText = `¬°Hola! Este es un ejemplo de texto que ser√° comprimido usando gzip.

Caracter√≠sticas de gzip:
- Algoritmo de compresi√≥n sin p√©rdida
- Muy eficiente para textos repetitivos
- Ampliamente utilizado en aplicaciones web
- Reduce significativamente el tama√±o de archivos

Este texto contiene suficiente contenido para demostrar la efectividad de la compresi√≥n gzip. Notar√°s que textos m√°s largos y con m√°s repeticiones obtienen mejores ratios de compresi√≥n.`;
            
            document.getElementById('textInput').value = exampleText;
        }
        
        // Ejemplo de datos de prueba (n√∫meros comprimidos)
        function loadExample() {
            const exampleData = "31,139,8,0,0,0,0,0,0,3,93,144,49,78,4,49,12,69,251,57,133,57,0,123,0,58,132,144,104,160,224,6,222,196,12,94,37,113,136,147,133,221,219,108,73,65,129,184,1,115,49,156,204,10,33,170,36,142,253,253,254,255,62,221,73,192,11,184,213,74,64,10,45,1,237,40,230,32,224,9,42,189,85,129,151,70,160,84,150,19,56,137,185,112,100,47,208,20,147,29,243,145,243,102,154,110,176,160,171,214,243,161,149,29,106,31,238,95,87,211,37,92,135,89,10,215,56,20,135,2,41,47,95,9,148,19,228,229,189,120,246,104,125,247,237,0,244,196,142,41,25,75,54,197,117,191,66,161,76,149,43,239,69,187,158,209,49,198,209,213,42,7,62,162,129,80,2,180,186,67,199,146,204,200,43,109,173,247,145,124,115,70,207,115,98,147,70,211,56,79,82,128,138,17,151,207,129,133,197,61,15,249,105,4,177,250,118,146,170,193,216,120,251,197,234,53,74,61,128,1,232,41,138,214,130,5,2,26,60,57,91,96,110,124,215,180,202,95,183,35,41,120,144,138,150,164,142,80,207,246,98,127,7,44,179,221,15,125,195,90,89,93,159,237,200,118,160,216,23,237,196,36,161,152,23,209,127,145,110,126,0,97,123,174,65,207,1,0,0";
            document.getElementById('numbersInput').value = exampleData;
        }
    </script>
</body>
</html>
